{% extends "base_admin.html" %}
{% load static %}

<!-- wrapper -->
{% block wrapper %}
<div class="wrapper">
    {% include "admin_partial/left_sidebar.html" %}

    <div class="content-page">
        <div class="content">
            {% include "admin_partial/topbar.html" %}
            <!-- Start Content-->
            <div class="container-fluid">

                <!-- start page title -->
                <div class="row">
                    <div class="col-12">
                        <div class="page-title-box">
                            <div class="page-title-right">
                                <ol class="breadcrumb m-0">
                                    <li class="breadcrumb-item"><a href="javascript: void(0);">SomaliRealEState</a>
                                    </li>
                                    <li class="breadcrumb-item"><a href="javascript: void(0);">Page</a></li>
                                    <li class="breadcrumb-item active">Edit Apartment</li>
                                </ol>
                            </div>
                            <h4 class="page-title">Edit an Apartement</h4>
                        </div>
                    </div>
                </div>
                <!-- end page title -->


                <!-- tab -->
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card">
                            <div class="card-body">
                                {% include "partials/alert_message.html" %}
                                <h4 class="mt-2">Basic Details</h4>

                                <p class="text-muted mb-4">The form below improves to
                                    update your apartment.</p>

                                <div id="rootwizard">
                                    <ul class="nav nav-pills nav-justified form-wizard-header mb-3">
                                        <li class="nav-item" data-target-form="#accountForm">
                                            <a href="#first" data-bs-toggle="tab" data-toggle="tab"
                                                class="nav-link rounded-0 pt-2 pb-2">
                                                <i class="mdi mdi-account-circle me-1"></i>
                                                <span class="d-none d-sm-inline">Basic Details</span>
                                            </a>
                                        </li>
                                        <li class="nav-item" data-target-form="#profileForm">
                                            <a href="#second" data-bs-toggle="tab" data-toggle="tab"
                                                class="nav-link rounded-0 pt-2 pb-2">
                                                <i class="mdi mdi-face-profile me-1"></i>
                                                <span class="d-none d-sm-inline">Location & Features</span>
                                            </a>
                                        </li>
                                        <li class="nav-item" data-target-form="#otherForm">
                                            <a href="#third" data-bs-toggle="tab" data-toggle="tab"
                                                class="nav-link rounded-0 pt-2 pb-2">
                                                <i class="mdi mdi-checkbox-marked-circle-outline me-1"></i>
                                                <span class="d-none d-sm-inline">Finish</span>
                                            </a>
                                        </li>
                                    </ul>
                                    
                                    <form id="accountForm" method="POST" action="{% url 'admin_dashboard:update_apartment_admin' apartment.id %}" enctype="multipart/form-data" class="form-horizontal">
                                        {% csrf_token %}
                                        <div class="tab-content mb-0 b-0">

                                            <div class="tab-pane" id="first">
                                                
                                                    <div class="row">
                                                        <div class="col-md-12">
                                                            <div class="mb-3">
                                                                <label for="apartment-name"
                                                                    class="form-label col-form-label">Apartment Name <span
                                                                        class="text-danger">*</span></label>
                                                                <input class="form-control" type="text"
                                                                    id="apartment-name"  value="{{ apartment.apartment_name }}"
                                                                    name="apartment-name" style="height: 40px;" required />
                                                            </div>

                                                        </div> <!-- end col -->

                                                    
                                                    </div> <!-- end row -->

                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <div class="mb-3">
                                                                <label for="year-built" class="form-label">Year Built
                                                                    <span class="text-danger">*</span></label>
                                                                <input class="form-control" type="year"
                                                                    value="{{ apartment.year_built }}"
                                                                    id="year-built" name="year-built"
                                                                    required />
                                                            </div>

                                                        </div> <!-- end col -->

                                                        <div class="col-md-6">
                                                            <div class="mb-3">
                                                                <label class="area">Area <span
                                                                        class="text-danger">*</span></label>
                                                                <div class="input-group flex-nowrap" style="margin-top: 8px;">
                                                                    <span class="input-group-text" id="basic-addon1">SQ
                                                                        Ft</span>
                                                                    <input type="text" class="form-control" aria-label="rent"
                                                                        aria-describedby="basic-addon1" id="area" name="area" value="{{ apartment.area }}"
                                                                        required>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div> <!-- end row -->

                                                    <div class="row">
                                                        <div class="col-12">
                                                            <div class="mb-3">
                                                                <label for="owners" class="form-label">Choose Your Name:</label>
                                                                    <select data-toggle="select2" title="owner-name" id="owners" name="owner-id" required style="height: 40px;">
                                                                        <option value="">Choose Your Name</option>
                                                                        {% for owner in owners %}
                                                                            <option value="{{ owner.id }}" {% if owner.id == apartment.owner.id %} selected {% endif %}>{{ owner.first_name }} {{ owner.middle_name }} {{ owner.last_name }}</option>
                                                                        {% endfor %}
                                                                    
                                                                        
                                                                    </select>
                                                                <div class="invalid-feedback">
                                                                Choose owner name
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- end col -->


                                                    </div> <!-- end row -->

                                                    <div class="row">
                                                        <div class="col-12">


                                                            <div class="mb-3">
                                                                <label for="description" class="form-label">Description
                                                                    (Optional)</label>
                                                                <textarea class="form-control" id="description"
                                                                    name="description"
                                                                    rows="3">{{ apartment.apartment_description }}</textarea>
                                                            </div>
                                                        </div>
                                                    </div> <!-- end row -->



                                            </div>

                                            <div class="tab-pane fade" id="second">
                                                <div class="row">
                                                    <div class="col-6">
                                                        <div class="mb-3">
                                                            <label for="apartment-location" class="form-label">Location <span
                                                                    class="text-danger">*</span></label>
                                                            <input class="form-control" type="text"
                                                                id="apartment-location"
                                                                name="location"
                                                                value="{{ apartment.location }}"
                                                                required />
                                                        </div>

                                                    </div>
                                                    <div class="col-md-6">
                                                        <div class="mb-3">
                                                            <label class="form-label">Choose district located
                                                                <span class="text-danger">*</span></label>
                                                            <select data-toggle="select2" title="District" id="district-located" name="district-located" required>
                                                                <option value"">Choose District Location</option>
                                                                <option value="Wadajir" {% if apartment.district_located == "Wadajir" %}selected{% endif %}>Wadajir</option>
                                                                <option value="Dharkenley" {% if apartment.district_located == "Dharkenley" %}selected{% endif %}>Dharkenley</option>
                                                                <option value="Deynile" {% if apartment.district_located == "Deynile" %}selected{% endif %}>Deynile</option>
                                                                <option value="Wardhigley" {% if apartment.district_located == "Wardhigley" %}selected{% endif %}>Wardhigley</option>
                                                                <option value="Howlwadag" {% if apartment.district_located == "Howlwadag" %}selected{% endif %}>Howlwadag</option>
                                                                <option value="Waberi" {% if apartment.district_located == "Waberi" %}selected{% endif %}>Waberi</option>
                                                                <option value="Habar jijab" {% if apartment.district_located == "Habar jijab" %}selected{% endif %}>Habar jijab</option>
                                                                <option value="Boondhere" {% if apartment.district_located == "Boondhere" %}selected{% endif %}>Boondhere</option>
                                                                <option value="Karaan" {% if apartment.district_located == "Karaan" %}selected{% endif %}>Karaan</option>
                                                                <option value="Yaqshid" {% if apartment.district_located == "Yaqshid" %}selected{% endif %}>Yaqshid</option>
                                                                <option value="Huriwaa" {% if apartment.district_located == "Huriwaa" %}selected{% endif %}>Huriwaa</option>
                                                                <option value="Kahda" {% if apartment.district_located == "Kahda" %}selected{% endif %}>Kahda</option>
                                                                <option value="Hodan" {% if apartment.district_located == "Hodan" %}selected{% endif %}>Hodan</option>
                                                                <option value="Shibis" {% if apartment.district_located == "Shibis" %}selected{% endif %}>Shibis</option>
                                                                <option value="Abdiaziz" {% if apartment.district_located == "Abdiaziz" %}selected{% endif %}>Abdiaziz</option>
                                                                <option value="Shangani" {% if apartment.district_located == "Shangani" %}selected{% endif %}>Shangani</option>
                                                                <option value="Daaru salam" {% if apartment.district_located == "Daaru salam" %}selected{% endif %}>Daaru salam</option>
                                                                <option value="Garasbaley" {% if apartment.district_located == "Garasbaley" %}selected{% endif %}>Garasbaley</option>

                                                            </select>
                                                            <div class="invalid-feedback">
                                                                Choose Distric Location
                                                            </div>
                                                        </div>

                                                    </div> <!-- end col -->
                                                    
                                                </div>
                                                <!-- end row -->

                                                <div class="row">
                                                    <div class="col-12">
                                                        <h4 class="mt-2">Apartment Features Checklist</h4>
                                                        <p>Customize your search by selecting the amenities and features that
                                                            matter most to you.</p>

                                                    </div>
                                                    <!-- end col -->
                                                </div>
                                                <!-- end row -->



                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <div class="mt-2">
                                                            <div class="form-check">
                                                                <input type="checkbox" class="form-check-input" id="gym"
                                                                    name="gym"  {% if features and features.has_gym %}checked{% endif %}>
                                                                <label class="form-check-label" for="gym" >Gym</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- end col -->

                                                    <div class="col-md-4">
                                                        <div class="mt-2">
                                                            <div class="form-check">
                                                                <input type="checkbox" class="form-check-input" id="alarm"
                                                                    name="alarm" {% if features and features.has_alarm %}checked{% endif %}>
                                                                <label class="form-check-label" for="alarm">Alarm</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="mt-2">
                                                            <div class="form-check">
                                                                <input type="checkbox" class="form-check-input" id="internet"
                                                                    name="internet" {% if features and features.has_internet %}checked{% endif %}>
                                                                <label class="form-check-label" for="internet">Internet</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- end col -->
                                                </div>
                                                <!-- end row -->

                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <div class="mt-2">
                                                            <div class="form-check">
                                                                <input type="checkbox" class="form-check-input"
                                                                    id="air-conditioner" name="air-conditioner" {% if features and features.has_air_conditioner %}checked{% endif %} >
                                                                <label class="form-check-label" for="air-conditioner">Air
                                                                    Conditioner</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- end col -->

                                                    <div class="col-md-4">
                                                        <div class="mt-2">
                                                            <div class="form-check">
                                                                <input type="checkbox" class="form-check-input" id="car-parking"
                                                                    name="car-parking" {% if features and features.has_car_parking %}checked{% endif %}>
                                                                <label class="form-check-label" for="car-parking">Car
                                                                    Parking</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="mt-2">
                                                            <div class="form-check">
                                                                <input type="checkbox" class="form-check-input"
                                                                    id="swimming-pool" name="swimming-pool" {% if features and features.has_swimming_pool %}checked{% endif %}>
                                                                <label class="form-check-label" for="swimming-pool">Swimming
                                                                    Pool</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- end col -->
                                                </div>
                                                <!-- end row -->


                                            </div>

                                            <div class="tab-pane fade" id="third">
                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h4 class="mt-2">Property Images</h4>
                                                        <p class="text-muted mb-4">Please Insert Pictures of the Apartment atleast one Pictures .</p>
                                                        <div class="mb-3">
                                                            <div class="row">
                                                                <div class="col-md-4">
                                                                    <div class="mb-3">
                                                                        <label for="img-1" class="form-label">Gallery_1 <span
                                                                                class="text-danger">*</span></label>
                                                                        <input type="file" id="img-1" name="images" class="form-control" style="height: 38px;">
                                                                        {% if existing_images.0 %}
                                                                            <img src="{{ existing_images.0.image.url }}" height="100" alt="Current Image 1">
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4">
                                                                    <div class="mb-3">
                                                                        <label for="img-2"
                                                                            class="form-label">Gallery_2</span></label>
                                                                        <input type="file" id="img-2" name="images" class="form-control" style="height: 38px;">
                                                                        {% if existing_images.1 %}
                                                                            <img src="{{ existing_images.1.image.url }}" height="100" alt="Current Image 2">
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-4">
                                                                    <div class="mb-3">
                                                                        <label for="img-3" class="form-label">Gallery_3</label>
                                                                        <input type="file" id="img-3" name="images" class="form-control" style="height: 38px;">
                                                                        {% if existing_images.2 %}
                                                                            <img src="{{ existing_images.2.image.url }}" height="100" alt="Current Image 3">
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                            </div> <!-- end row -->
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- end row -->

                                                <div class="row">
                                                    <div class="col-md-12">
                                                        <h4 class="mt-2">Property Video</h4>
                                                        <p class="text-muted mb-4">Please Insert one Video of the Apartment.</p>
                                                        <div class="mb-3">
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <div class="mb-3">
                                                                        <label for="video" class="form-label">Video <span
                                                                                class="text-danger">*</span></label>
                                                                        <input type="file" id="video" name="video" class="form-control">
                                                                        {% if apartment.video %}
                                                                            <!-- Displaying existing video if available -->
                                                                            <video width="100%" height="240" controls style="margin-top: 10px;">
                                                                                <source src="{{ apartment.video.url }}" type="video/mp4">
                                                                                Your browser does not support the video tag.
                                                                            </video>
                                                                        {% endif %}
                                                                    </div>
                                                                </div>
                                                            </div> <!-- end row -->
                                                        </div>
                                                    </div>
                                                </div> <!-- end row -->

                                            
                                                
                                                
                                            </div>

                                            <ul class="list-inline wizard mb-0 mt-4">
                                                <li class="previous list-inline-item"><a href="javascript:void(0);" class="btn btn-danger" id="previous-button">Previous</a></li>
                                                <li class="next list-inline-item float-end"><a href="javascript:void(0);" class="btn btn-danger" id="next-button">Next</a></li>
                                                <li class="submit list-inline-item float-end" style="display: none;">
                                                    <button class="btn btn-primary" type="submit">
                                                        <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                                        <span class="button-text">Save Change</span>
                                                    </button>
                                                </li>
                                            </ul>

                                        </div> <!-- tab-content -->
                                    </form>
                                </div> <!-- end #rootwizard-->
                                

                            </div> <!-- end card-body -->
                        </div> <!-- end card-->
                    </div> <!-- end col -->
                </div>
                <!-- end row-->

            </div> <!-- container -->

            {% include "admin_partial/footer.html" %}
        </div>

    </div>
</div>
{% endblock %}


<!-- right_sidebar -->
{% block right_sidebar %}

{% include "admin_partial/right_sidebar.html" %}

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var $ = jQuery; // Ensure jQuery is available as '$'
        const nextButton = document.getElementById('next-button');
        const previousButton = document.getElementById('previous-button');
        const submitButton = document.querySelector('.submit');
        const navLinks = $('#rootwizard .nav-link');
        const totalTabs = navLinks.length;
        let currentIndex = 0;
    
        function updateButtonVisibility() {
            if (currentIndex === totalTabs - 1) {  // Last tab
                nextButton.style.display = 'none';
                submitButton.style.display = 'inline-block';
            } else {
                nextButton.style.display = 'inline-block';
                submitButton.style.display = 'none';
            }
            previousButton.style.display = currentIndex === 0 ? 'none' : 'inline-block';
        }
    
        navLinks.each(function(index) {
            $(this).on('click', function (e) {
                e.preventDefault();
                currentIndex = index;
                $(this).tab('show');
                updateButtonVisibility();
            });
        });
    
        nextButton.addEventListener('click', function() {
            if (currentIndex < totalTabs - 1) {
                currentIndex++;
                $(navLinks[currentIndex]).tab('show');
            }
            updateButtonVisibility();
        });
    
        previousButton.addEventListener('click', function() {
            if (currentIndex > 0) {
                currentIndex--;
                $(navLinks[currentIndex]).tab('show');
            }
            updateButtonVisibility();
        });
    
        updateButtonVisibility(); // Initial button setup
    });
    </script>
{% endblock %}